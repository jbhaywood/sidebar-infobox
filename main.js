/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => SidebarInfobox
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// view.ts
var import_obsidian2 = require("obsidian");

// settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  imageProperty: "image",
  imagesProperty: "images",
  excludeProperties: "",
  maxImageHeight: 500,
  sortProperties: false,
  capitalizePropertyName: false
};
var SidebarInfoboxSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Maximum Image Height").setDesc("Value in pixels. Set to zero for no maximum.").addText((text) => {
      var _a;
      return text.setPlaceholder(DEFAULT_SETTINGS.maxImageHeight.toString()).setValue((_a = this.plugin.settings.maxImageHeight) == null ? void 0 : _a.toString()).onChange(async (value) => {
        this.plugin.settings.maxImageHeight = parseInt(value);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Image Property").setDesc("The name of the frontmatter property to use for the main image shown above the properties table. It should be the name of the image file located somewhere in the vault.").addText((text) => text.setPlaceholder(DEFAULT_SETTINGS.imageProperty).setValue(this.plugin.settings.imageProperty).onChange(async (value) => {
      this.plugin.settings.imageProperty = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Images Property").setDesc("The name of the frontmatter property to use for additional images. This is an array property, with each value being the name of the image file located somewhere in the vault.").addText((text) => text.setPlaceholder(DEFAULT_SETTINGS.imagesProperty).setValue(this.plugin.settings.imagesProperty).onChange(async (value) => {
      this.plugin.settings.imagesProperty = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Excluded Properties").setDesc("The names of the frontmatter properties to exclude from the table. List them all on one line, with each followed by a comma.").addTextArea((text) => text.setValue(this.plugin.settings.excludeProperties).onChange(async (value) => {
      this.plugin.settings.excludeProperties = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Sort Properties").setDesc("Whether or not to sort the properties alphabetically in the table.").addToggle((toggle) => toggle.setValue(this.plugin.settings.sortProperties).onChange(async (value) => {
      this.plugin.settings.sortProperties = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Capitalize Property Names").setDesc("Whether or not to capitalize the property names.").addToggle((toggle) => toggle.setValue(this.plugin.settings.capitalizePropertyName).onChange(async (value) => {
      this.plugin.settings.capitalizePropertyName = value;
      await this.plugin.saveSettings();
    }));
  }
};

// view.ts
var viewType = "SidebarInfoboxView";
var SidebarInfoboxView = class extends import_obsidian2.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.plugin = plugin;
    this.observers = [];
    this.contentEl.addClass("sidebar-infobox-view");
    this.setNoContentMessage();
  }
  async onOpen() {
    console.log("Sidebar Infobox view opened");
    this.setViewContent();
  }
  setViewContent() {
    this.disconnectObservers();
    let frontmatter;
    const activeFile = this.tryGetActiveFile();
    if (activeFile) {
      const metadata = this.app.metadataCache.getFileCache(activeFile);
      if (metadata == null ? void 0 : metadata.frontmatter) {
        frontmatter = metadata.frontmatter;
      }
    }
    if (frontmatter) {
      this.contentEl.empty();
      const root = this.contentEl.createDiv("sidebar-infobox-view");
      const imagePropertyName = this.plugin.settings.imageProperty || DEFAULT_SETTINGS.imageProperty;
      const imagesPropertyName = this.plugin.settings.imagesProperty || DEFAULT_SETTINGS.imagesProperty;
      const excludedProperties = this.plugin.settings.excludeProperties.split(",").map((str) => str.trim());
      if (imagePropertyName) {
        excludedProperties.push(imagePropertyName);
      }
      if (imagesPropertyName) {
        excludedProperties.push(imagesPropertyName);
      }
      let values = [...Object.entries(frontmatter)];
      if (this.plugin.settings.sortProperties) {
        values.sort((a, b) => a[0].localeCompare(b[0]));
      }
      const imgPanel = root.createDiv("sidebar-infobox-image-viewer");
      const imageLinks = [];
      const table = root.createEl("table");
      const head = table.createTHead();
      const row = head.createEl("tr");
      row.createEl("th", { text: "Stat" });
      row.createEl("th", { text: "Value" });
      const body = table.createTBody();
      for (const item of values) {
        const propName = item[0];
        const propValue = item[1];
        if (propName === imagePropertyName) {
          imageLinks.unshift(propValue);
          continue;
        }
        if (propName === imagesPropertyName) {
          for (const val of propValue) {
            imageLinks.push(val);
          }
          continue;
        }
        if (excludedProperties.includes(propName)) {
          continue;
        }
        const row2 = body.createEl("tr");
        const propNameCell = row2.createEl("td", { text: propName });
        if (this.plugin.settings.capitalizePropertyName) {
          propNameCell.style.textTransform = "capitalize";
        }
        const valueCell = row2.createEl("td");
        if (this.isUrl(propValue)) {
          const link = valueCell.createEl("a", { text: propValue.split("/").last() });
          link.href = propValue;
        } else {
          if (activeFile) {
            this.setEditableText(propName, propValue, activeFile, valueCell);
          }
        }
      }
      if (imageLinks.length) {
        const img = imgPanel.createEl("img", { cls: "main-image" });
        let curIdx = 0;
        this.setImage(imageLinks[curIdx], img);
        if (imageLinks.length > 1) {
          const leftArrow = imgPanel.createEl("button", { text: "Previous", cls: "prev-btn" });
          const rightArrow = imgPanel.createEl("button", { text: "Next", cls: "next-btn" });
          leftArrow.addEventListener("click", () => {
            curIdx = curIdx > 0 ? curIdx - 1 : imageLinks.length - 1;
            this.setImageFromClick(imageLinks[curIdx], img);
          });
          rightArrow.addEventListener("click", () => {
            curIdx = curIdx < imageLinks.length - 1 ? curIdx + 1 : 0;
            this.setImageFromClick(imageLinks[curIdx], img);
          });
        }
      } else {
        imgPanel.remove();
      }
    } else {
      this.setNoContentMessage();
    }
  }
  isUrl(str) {
    return /^(https?:\/\/).+/i.exec(str);
  }
  // This uses 'lastActiveFile', which isn't documented. But it's necessary for the case
  // where the user switches to a different sidebar view and then back to the infobox.
  tryGetActiveFile() {
    let activeFile = this.app.workspace.lastActiveFile;
    if (!activeFile) {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
      if (activeView && activeView.file) {
        activeFile = activeView.file;
      }
    }
    return activeFile;
  }
  setEditableText(propName, propValue, activeFile, tableCell) {
    const input = tableCell.createDiv({
      text: propValue,
      cls: "sidebar-infobox-edit-box",
      attr: { "contenteditable": "" }
    });
    const config = {
      childList: true,
      subtree: true,
      characterData: true
    };
    const observer = new MutationObserver(
      (0, import_obsidian2.debounce)(
        (mutations) => {
          for (const mutation of mutations) {
            if (mutation.type === "characterData") {
              this.app.fileManager.processFrontMatter(activeFile, (fm) => {
                fm[propName] = mutation.target.textContent;
              });
            }
            if (mutation.type === "childList") {
              this.app.fileManager.processFrontMatter(activeFile, (fm) => {
                fm[propName] = mutation.target.textContent;
              });
              break;
            }
          }
        },
        500,
        true
      )
    );
    this.observers.push(observer);
    observer.observe(input, config);
  }
  setImageFromClick(fileName, img) {
    this.internalViewChange = true;
    this.setImage(fileName, img);
    setTimeout(() => {
      this.internalViewChange = false;
    }, 200);
  }
  setImage(fileName, img) {
    var _a;
    if (fileName.includes("[[")) {
      const imageFileMatch = /!?\[\[(?<filename>.+)\]\]/.exec(fileName);
      fileName = ((_a = imageFileMatch == null ? void 0 : imageFileMatch.groups) == null ? void 0 : _a.filename) || "";
    }
    if (!fileName)
      return;
    new Promise((resolve, reject) => {
      const imageFile = this.app.vault.getFiles().find((f) => f.name === fileName);
      let maxHeight = DEFAULT_SETTINGS.maxImageHeight.toString() + "px";
      if (this.plugin.settings.maxImageHeight === 0) {
        maxHeight = "none";
      } else if (this.plugin.settings.maxImageHeight) {
        maxHeight = this.plugin.settings.maxImageHeight.toString() + "px";
      }
      img.style.maxHeight = maxHeight;
      if (imageFile) {
        resolve(imageFile);
      } else {
        reject("Can't locate image file.");
      }
    }).then((imageFile) => {
      const file = this.app.vault.adapter.getResourcePath(imageFile.path);
      img.src = file;
    }).catch((message) => {
      img.remove();
      console.log(`Sidebar Infobox: ${message}`);
    });
  }
  setNoContentMessage() {
    this.contentEl.empty();
    this.contentEl.createDiv({
      cls: "pane-empty",
      text: "Nothing to display."
    });
  }
  disconnectObservers() {
    for (const observer of this.observers) {
      observer.disconnect();
      this.observers = [];
    }
  }
  getViewType() {
    return viewType;
  }
  getDisplayText() {
    return "Sidebar Infobox";
  }
  getIcon() {
    return "lines-of-text";
  }
  async onClose() {
    this.disconnectObservers();
    await super.onClose();
  }
};

// main.ts
var SidebarInfobox = class extends import_obsidian3.Plugin {
  async onload() {
    const { app } = this;
    await this.loadSettings();
    this.registerView(
      viewType,
      (leaf) => new SidebarInfoboxView(leaf, this)
    );
    this.addSettingTab(new SidebarInfoboxSettingTab(this.app, this));
    this.addCommand({
      id: "show-sidebar-infobox",
      name: "Show Sidebar Infobox",
      callback: async () => {
        this.initLeaf();
      }
    });
    this.registerEvent(
      app.metadataCache.on(
        "changed",
        (0, import_obsidian3.debounce)(
          (file) => {
            var _a;
            const activeView = app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
            if (activeView && file === activeView.file) {
              (_a = this.view) == null ? void 0 : _a.setViewContent();
            }
          },
          100,
          true
        )
      )
    );
    this.registerEvent(
      app.workspace.on(
        "active-leaf-change",
        (0, import_obsidian3.debounce)(
          () => {
            var _a, _b;
            if (!((_a = this.view) == null ? void 0 : _a.internalViewChange)) {
              (_b = this.view) == null ? void 0 : _b.setViewContent();
            }
          },
          100,
          true
        )
      )
    );
    (async () => {
      await this.initLeaf();
    })();
  }
  onunload() {
    this.app.workspace.getLeavesOfType(viewType).forEach((leaf) => leaf.detach());
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  get view() {
    const leaves = this.app.workspace.getLeavesOfType(viewType);
    if (!(leaves == null ? void 0 : leaves.length))
      return null;
    return leaves[0].view;
  }
  async initLeaf() {
    if (this.view)
      return this.revealLeaf();
    if (this.app.workspace) {
      await this.app.workspace.getRightLeaf(false).setViewState({
        type: viewType
      });
      this.revealLeaf();
    }
  }
  revealLeaf() {
    var _a;
    const leaves = this.app.workspace.getLeavesOfType(viewType);
    if (!(leaves == null ? void 0 : leaves.length))
      return;
    this.app.workspace.revealLeaf(leaves[0]);
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (activeView) {
      (_a = this.view) == null ? void 0 : _a.setViewContent();
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJ2aWV3LnRzIiwgInNldHRpbmdzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge1xyXG5cdE1hcmtkb3duVmlldyxcclxuXHRQbHVnaW4sXHJcblx0V29ya3NwYWNlTGVhZixcclxuXHRkZWJvdW5jZVxyXG59IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmltcG9ydCB7XHJcblx0U2lkZWJhckluZm9ib3hWaWV3LFxyXG5cdHZpZXdUeXBlXHJcbn0gZnJvbSAnLi92aWV3JztcclxuXHJcbmltcG9ydCB7XHJcblx0U2lkZWJhckluZm9ib3hTZXR0aW5ncyxcclxuXHRTaWRlYmFySW5mb2JveFNldHRpbmdUYWIsXHJcblx0REVGQVVMVF9TRVRUSU5HU1xyXG59IGZyb20gXCIuL3NldHRpbmdzXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNpZGViYXJJbmZvYm94IGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogU2lkZWJhckluZm9ib3hTZXR0aW5ncztcclxuXHRsYXN0QWN0aXZlVmlldzogTWFya2Rvd25WaWV3IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRjb25zdCB7IGFwcCB9ID0gdGhpcztcclxuXHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxyXG5cdFx0XHR2aWV3VHlwZSxcclxuXHRcdFx0KGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IG5ldyBTaWRlYmFySW5mb2JveFZpZXcobGVhZiwgdGhpcylcclxuXHRcdCk7XHJcblxyXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc2V0dGluZ3MgdGFiIHNvIHRoZSB1c2VyIGNhbiBjb25maWd1cmUgdmFyaW91cyBhc3BlY3RzIG9mIHRoZSBwbHVnaW5cclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2lkZWJhckluZm9ib3hTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICdzaG93LXNpZGViYXItaW5mb2JveCcsXHJcblx0XHRcdG5hbWU6ICdTaG93IFNpZGViYXIgSW5mb2JveCcsXHJcblx0XHRcdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5pbml0TGVhZigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxyXG5cdFx0XHRhcHAubWV0YWRhdGFDYWNoZS5vbihcclxuXHRcdFx0XHQnY2hhbmdlZCcsXHJcblx0XHRcdFx0ZGVib3VuY2UoXHJcblx0XHRcdFx0XHQoZmlsZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBhY3RpdmVWaWV3ID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblxyXG5cdFx0XHRcdFx0XHRpZiAoYWN0aXZlVmlldyAmJiBmaWxlID09PSBhY3RpdmVWaWV3LmZpbGUpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnZpZXc/LnNldFZpZXdDb250ZW50KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHQxMDAsXHJcblx0XHRcdFx0XHR0cnVlXHJcblx0XHRcdFx0KVxyXG5cdFx0XHQpXHJcblx0XHQpO1xyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0YXBwLndvcmtzcGFjZS5vbihcclxuXHRcdFx0XHQnYWN0aXZlLWxlYWYtY2hhbmdlJyxcclxuXHRcdFx0XHRkZWJvdW5jZShcclxuXHRcdFx0XHRcdCgpID0+IHtcclxuXHRcdFx0XHRcdFx0aWYgKCF0aGlzLnZpZXc/LmludGVybmFsVmlld0NoYW5nZSkge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudmlldz8uc2V0Vmlld0NvbnRlbnQoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdDEwMCxcclxuXHRcdFx0XHRcdHRydWVcclxuXHRcdFx0XHQpXHJcblx0XHRcdClcclxuXHRcdCk7XHJcblxyXG5cdFx0KGFzeW5jICgpID0+IHtcclxuXHRcdFx0YXdhaXQgdGhpcy5pbml0TGVhZigpO1xyXG5cdFx0fSkoKTtcclxuXHR9XHJcblxyXG5cdG9udW5sb2FkKCkge1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlXHJcblx0XHRcdC5nZXRMZWF2ZXNPZlR5cGUodmlld1R5cGUpXHJcblx0XHRcdC5mb3JFYWNoKChsZWFmKSA9PiBsZWFmLmRldGFjaCgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdGdldCB2aWV3KCkge1xyXG5cdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSh2aWV3VHlwZSk7XHJcblx0XHRpZiAoIWxlYXZlcz8ubGVuZ3RoKSByZXR1cm4gbnVsbDtcclxuXHRcdHJldHVybiBsZWF2ZXNbMF0udmlldyBhcyBTaWRlYmFySW5mb2JveFZpZXc7XHJcblx0fVxyXG5cclxuXHRhc3luYyBpbml0TGVhZigpIHtcclxuXHRcdGlmICh0aGlzLnZpZXcpIHJldHVybiB0aGlzLnJldmVhbExlYWYoKTtcclxuXHJcblx0XHRpZiAodGhpcy5hcHAud29ya3NwYWNlKSB7XHJcblx0XHRcdGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpLnNldFZpZXdTdGF0ZSh7XHJcblx0XHRcdFx0dHlwZTogdmlld1R5cGUsXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5yZXZlYWxMZWFmKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXZlYWxMZWFmKCkge1xyXG5cdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSh2aWV3VHlwZSk7XHJcblx0XHRpZiAoIWxlYXZlcz8ubGVuZ3RoKSByZXR1cm47XHJcblxyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLnJldmVhbExlYWYobGVhdmVzWzBdKTtcclxuXHJcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHJcblx0XHRpZiAoYWN0aXZlVmlldykge1xyXG5cdFx0XHR0aGlzLnZpZXc/LnNldFZpZXdDb250ZW50KCk7XHJcblx0XHR9XHJcblx0fVxyXG59IiwgIi8vIFRPRE86XHJcbi8vICAtIERvbid0IHVwZGF0ZSB3aGVuIHRoZSBsZWZ0IHBhbmVsIGlzIHNlbGVjdGVkXHJcblxyXG5pbXBvcnQge1xyXG4gICAgRnJvbnRNYXR0ZXJDYWNoZSxcclxuICAgIEl0ZW1WaWV3LFxyXG4gICAgTWFya2Rvd25WaWV3LFxyXG4gICAgVEZpbGUsXHJcbiAgICBXb3Jrc3BhY2VMZWFmLCBkZWJvdW5jZVxyXG59IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgU2lkZWJhckluZm9ib3ggZnJvbSBcIi4vbWFpblwiO1xyXG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuXHJcbmV4cG9ydCBjb25zdCB2aWV3VHlwZSA9IFwiU2lkZWJhckluZm9ib3hWaWV3XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2lkZWJhckluZm9ib3hWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gICAgYWN0aXZlTWFya2Rvd25MZWFmOiBNYXJrZG93blZpZXc7XHJcbiAgICBwbHVnaW46IFNpZGViYXJJbmZvYm94O1xyXG4gICAgb2JzZXJ2ZXJzOiBNdXRhdGlvbk9ic2VydmVyW107XHJcbiAgICBpbnRlcm5hbFZpZXdDaGFuZ2U6IGJvb2xlYW47XHJcblxyXG4gICAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBTaWRlYmFySW5mb2JveCkge1xyXG4gICAgICAgIHN1cGVyKGxlYWYpO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5jb250ZW50RWwuYWRkQ2xhc3MoXCJzaWRlYmFyLWluZm9ib3gtdmlld1wiKTtcclxuICAgICAgICB0aGlzLnNldE5vQ29udGVudE1lc3NhZ2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTaWRlYmFyIEluZm9ib3ggdmlldyBvcGVuZWRcIik7XHJcbiAgICAgICAgdGhpcy5zZXRWaWV3Q29udGVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFZpZXdDb250ZW50KCkge1xyXG4gICAgICAgIHRoaXMuZGlzY29ubmVjdE9ic2VydmVycygpO1xyXG5cclxuICAgICAgICBsZXQgZnJvbnRtYXR0ZXI6IEZyb250TWF0dGVyQ2FjaGUgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMudHJ5R2V0QWN0aXZlRmlsZSgpO1xyXG5cclxuICAgICAgICBpZiAoYWN0aXZlRmlsZSkge1xyXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGFjdGl2ZUZpbGUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKG1ldGFkYXRhPy5mcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXIgPSBtZXRhZGF0YS5mcm9udG1hdHRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGZyb250bWF0dGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJvb3QgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoXCJzaWRlYmFyLWluZm9ib3gtdmlld1wiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGltYWdlUHJvcGVydHlOYW1lID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW1hZ2VQcm9wZXJ0eSB8fCBERUZBVUxUX1NFVFRJTkdTLmltYWdlUHJvcGVydHk7XHJcbiAgICAgICAgICAgIGNvbnN0IGltYWdlc1Byb3BlcnR5TmFtZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmltYWdlc1Byb3BlcnR5IHx8IERFRkFVTFRfU0VUVElOR1MuaW1hZ2VzUHJvcGVydHk7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4Y2x1ZGVkUHJvcGVydGllcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVQcm9wZXJ0aWVzLnNwbGl0KFwiLFwiKS5tYXAoc3RyID0+IHN0ci50cmltKCkpO1xyXG5cclxuICAgICAgICAgICAgLy8gQWxzbyBleGNsdWRlIHRoZSBpbWFnZSBwcm9wZXJ0aWVzLCBpZiB0aGV5J3JlIGRlZmluZWQuXHJcbiAgICAgICAgICAgIGlmIChpbWFnZVByb3BlcnR5TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgZXhjbHVkZWRQcm9wZXJ0aWVzLnB1c2goaW1hZ2VQcm9wZXJ0eU5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoaW1hZ2VzUHJvcGVydHlOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFByb3BlcnRpZXMucHVzaChpbWFnZXNQcm9wZXJ0eU5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgdmFsdWVzID0gWy4uLk9iamVjdC5lbnRyaWVzKGZyb250bWF0dGVyKV07XHJcblxyXG4gICAgICAgICAgICAvLyBTb3J0IHRoZSBwcm9wZXJ0aWVzIGlmIG5lZWRlZCwgYmFzZWQgb24gdGhlIHNldHRpbmdzLlxyXG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydFByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlcy5zb3J0KChhLCBiKSA9PiBhWzBdLmxvY2FsZUNvbXBhcmUoYlswXSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGltZyBwYW5lbCBmaXJzdCBzbyB0aGF0IGl0IHNpdHMgYWJvdmUgdGhlIHByb3BlcnRpZXMgdGFibGUuXHJcbiAgICAgICAgICAgIGNvbnN0IGltZ1BhbmVsID0gcm9vdC5jcmVhdGVEaXYoXCJzaWRlYmFyLWluZm9ib3gtaW1hZ2Utdmlld2VyXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBpbWFnZUxpbmtzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdGFibGUgPSByb290LmNyZWF0ZUVsKFwidGFibGVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlYWQgPSB0YWJsZS5jcmVhdGVUSGVhZCgpO1xyXG4gICAgICAgICAgICBjb25zdCByb3cgPSBoZWFkLmNyZWF0ZUVsKFwidHJcIik7XHJcblxyXG4gICAgICAgICAgICByb3cuY3JlYXRlRWwoXCJ0aFwiLCB7IHRleHQ6IFwiU3RhdFwiIH0pO1xyXG4gICAgICAgICAgICByb3cuY3JlYXRlRWwoXCJ0aFwiLCB7IHRleHQ6IFwiVmFsdWVcIiB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB0YWJsZS5jcmVhdGVUQm9keSgpO1xyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHZhbHVlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvcE5hbWUgPSBpdGVtWzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvcFZhbHVlID0gPGFueT5pdGVtWzFdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwcm9wTmFtZSA9PT0gaW1hZ2VQcm9wZXJ0eU5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIG1haW4gaW1hZ2UgaXMgYWx3YXlzIGZpcnN0IGluIHRoZSBhcnJheS5cclxuICAgICAgICAgICAgICAgICAgICBpbWFnZUxpbmtzLnVuc2hpZnQocHJvcFZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocHJvcE5hbWUgPT09IGltYWdlc1Byb3BlcnR5TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdmFsIG9mIHByb3BWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUxpbmtzLnB1c2godmFsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVkUHJvcGVydGllcy5pbmNsdWRlcyhwcm9wTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBib2R5LmNyZWF0ZUVsKFwidHJcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9wTmFtZUNlbGwgPSByb3cuY3JlYXRlRWwoXCJ0ZFwiLCB7IHRleHQ6IHByb3BOYW1lIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXBpdGFsaXplUHJvcGVydHlOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcE5hbWVDZWxsLnN0eWxlLnRleHRUcmFuc2Zvcm0gPSBcImNhcGl0YWxpemVcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZUNlbGwgPSByb3cuY3JlYXRlRWwoXCJ0ZFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1VybChwcm9wVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IHZhbHVlQ2VsbC5jcmVhdGVFbChcImFcIiwgeyB0ZXh0OiBwcm9wVmFsdWUuc3BsaXQoXCIvXCIpLmxhc3QoKSB9KTtcclxuICAgICAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBwcm9wVmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RWRpdGFibGVUZXh0KHByb3BOYW1lLCBwcm9wVmFsdWUsIGFjdGl2ZUZpbGUsIHZhbHVlQ2VsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoaW1hZ2VMaW5rcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGltZyA9IGltZ1BhbmVsLmNyZWF0ZUVsKFwiaW1nXCIsIHsgY2xzOiBcIm1haW4taW1hZ2VcIiB9KTtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJJZHggPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0SW1hZ2UoaW1hZ2VMaW5rc1tjdXJJZHhdLCBpbWcpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpbWFnZUxpbmtzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWZ0QXJyb3cgPSBpbWdQYW5lbC5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiUHJldmlvdXNcIiwgY2xzOiBcInByZXYtYnRuXCIgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmlnaHRBcnJvdyA9IGltZ1BhbmVsLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJOZXh0XCIsIGNsczogXCJuZXh0LWJ0blwiIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZWZ0QXJyb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySWR4ID0gKGN1cklkeCA+IDApID8gY3VySWR4IC0gMSA6IGltYWdlTGlua3MubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJbWFnZUZyb21DbGljayhpbWFnZUxpbmtzW2N1cklkeF0sIGltZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0QXJyb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySWR4ID0gKGN1cklkeCA8IGltYWdlTGlua3MubGVuZ3RoIC0gMSkgPyBjdXJJZHggKyAxIDogMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJbWFnZUZyb21DbGljayhpbWFnZUxpbmtzW2N1cklkeF0sIGltZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpbWdQYW5lbC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Tm9Db250ZW50TWVzc2FnZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpc1VybChzdHI6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiAvXihodHRwcz86XFwvXFwvKS4rL2kuZXhlYyhzdHIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRoaXMgdXNlcyAnbGFzdEFjdGl2ZUZpbGUnLCB3aGljaCBpc24ndCBkb2N1bWVudGVkLiBCdXQgaXQncyBuZWNlc3NhcnkgZm9yIHRoZSBjYXNlXHJcbiAgICAvLyB3aGVyZSB0aGUgdXNlciBzd2l0Y2hlcyB0byBhIGRpZmZlcmVudCBzaWRlYmFyIHZpZXcgYW5kIHRoZW4gYmFjayB0byB0aGUgaW5mb2JveC5cclxuICAgIHRyeUdldEFjdGl2ZUZpbGUoKTogVEZpbGUgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIGxldCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmxhc3RBY3RpdmVGaWxlO1xyXG5cclxuICAgICAgICBpZiAoIWFjdGl2ZUZpbGUpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbGUgPSBhY3RpdmVWaWV3LmZpbGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBhY3RpdmVGaWxlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEVkaXRhYmxlVGV4dChcclxuICAgICAgICBwcm9wTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIHByb3BWYWx1ZTogc3RyaW5nLFxyXG4gICAgICAgIGFjdGl2ZUZpbGU6IFRGaWxlLFxyXG4gICAgICAgIHRhYmxlQ2VsbDogSFRNTFRhYmxlQ2VsbEVsZW1lbnQpIHtcclxuICAgICAgICAvLyBVc2luZyBhbiBlZGl0YWJsZSBkaXYgYmVjYXVzZSBpdCBhdXRvIHNpemVzIHRvIHRoZSB0ZXh0IGluc2lkZSBvZiBpdCxcclxuICAgICAgICAvLyB1bmxpa2UgYSBUZXh0QXJlYSB0aGF0IHRha2VzIGEgbG90IG1vcmUgd29yayB0byBkbyB0aGUgc2FtZS5cclxuICAgICAgICBjb25zdCBpbnB1dCA9IHRhYmxlQ2VsbC5jcmVhdGVEaXYoe1xyXG4gICAgICAgICAgICB0ZXh0OiBwcm9wVmFsdWUsXHJcbiAgICAgICAgICAgIGNsczogXCJzaWRlYmFyLWluZm9ib3gtZWRpdC1ib3hcIixcclxuICAgICAgICAgICAgYXR0cjogeyBcImNvbnRlbnRlZGl0YWJsZVwiOiBcIlwiIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQ29uZmlndXJhdGlvbiBmb3Igb2JzZXJ2aW5nIHRleHR1YWwgY2hhbmdlc1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHtcclxuICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxyXG4gICAgICAgICAgICBzdWJ0cmVlOiB0cnVlLFxyXG4gICAgICAgICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoXHJcbiAgICAgICAgICAgIGRlYm91bmNlKFxyXG4gICAgICAgICAgICAgICAgKG11dGF0aW9uczogTXV0YXRpb25SZWNvcmRbXSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSB0eXBpbmcgaW50byB0aGUgZGl2LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjaGFyYWN0ZXJEYXRhXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihhY3RpdmVGaWxlLCAoZm06IEZyb250TWF0dGVyQ2FjaGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbVtwcm9wTmFtZV0gPSBtdXRhdGlvbi50YXJnZXQudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIHBhc3RpbmcgaW50byB0aGUgZGl2LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjaGlsZExpc3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGFjdGl2ZUZpbGUsIChmbTogRnJvbnRNYXR0ZXJDYWNoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtW3Byb3BOYW1lXSA9IG11dGF0aW9uLnRhcmdldC50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgNTAwLFxyXG4gICAgICAgICAgICAgICAgdHJ1ZVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XHJcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShpbnB1dCwgY29uZmlnKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbWFnZUZyb21DbGljayhmaWxlTmFtZTogc3RyaW5nLCBpbWc6IEhUTUxJbWFnZUVsZW1lbnQpIHtcclxuICAgICAgICAvLyBXZSBkb24ndCB3YW50IHRoZSAnYWN0aXZlLWxlYWYtY2hhbmdlJyBldmVudCB0byByZXNldCB0aGUgaW1hZ2UgYWZ0ZXIgXHJcbiAgICAgICAgLy8gdGhlIGJ1dHRvbiBjbGljaywgc2luY2UgY2xpY2tpbmcgb24gaXQgYWxzbyBzZWxlY3MgdGhlIGluZm9ib3ggcGFuZWxcclxuICAgICAgICAvLyBhbmQgcmVnaXN0ZXJzIGFzIGEgbGVhZiBjaGFuZ2UuXHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbFZpZXdDaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLnNldEltYWdlKGZpbGVOYW1lLCBpbWcpO1xyXG5cclxuICAgICAgICAvLyBSZXNldCBhZnRlciBhIHNsaWdodCBkZWxheSB0byBhY2NvdW50IGZvciB0aGUgZGVib3VuY2UgdGltZSBpbiB0aGVcclxuICAgICAgICAvLyAnYWN0aXZlLWxlYWYtY2hhbmdlJyBldmVudCBoYW5kbGVyLlxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmludGVybmFsVmlld0NoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgIH0sIDIwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SW1hZ2UoZmlsZU5hbWU6IHN0cmluZywgaW1nOiBIVE1MSW1hZ2VFbGVtZW50KSB7XHJcbiAgICAgICAgLy8gU2VlIGlmIHRoaXMgaXMgdXNpbmcgbGluayBmb3JtYXQgYW5kIGV4dHJhY3QgdGhlIG5hbWUgaWYgc28uXHJcbiAgICAgICAgaWYgKGZpbGVOYW1lLmluY2x1ZGVzKFwiW1tcIikpIHtcclxuICAgICAgICAgICAgY29uc3QgaW1hZ2VGaWxlTWF0Y2ggPSAvIT9cXFtcXFsoPzxmaWxlbmFtZT4uKylcXF1cXF0vLmV4ZWMoZmlsZU5hbWUpO1xyXG4gICAgICAgICAgICBmaWxlTmFtZSA9IGltYWdlRmlsZU1hdGNoPy5ncm91cHM/LmZpbGVuYW1lIHx8IFwiXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWZpbGVOYW1lKSByZXR1cm47XHJcblxyXG4gICAgICAgIG5ldyBQcm9taXNlPFRGaWxlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGltYWdlRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKClcclxuICAgICAgICAgICAgICAgIC5maW5kKGYgPT4gZi5uYW1lID09PSBmaWxlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgbWF4SGVpZ2h0ID0gREVGQVVMVF9TRVRUSU5HUy5tYXhJbWFnZUhlaWdodC50b1N0cmluZygpICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heEltYWdlSGVpZ2h0ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhJbWFnZUhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4SW1hZ2VIZWlnaHQudG9TdHJpbmcoKSArIFwicHhcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW1nLnN0eWxlLm1heEhlaWdodCA9IG1heEhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIGlmIChpbWFnZUZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoaW1hZ2VGaWxlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChcIkNhbid0IGxvY2F0ZSBpbWFnZSBmaWxlLlwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChpbWFnZUZpbGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmdldFJlc291cmNlUGF0aChpbWFnZUZpbGUucGF0aCk7XHJcbiAgICAgICAgICAgICAgICBpbWcuc3JjID0gZmlsZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChtZXNzYWdlOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgICAgIGltZy5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaWRlYmFyIEluZm9ib3g6ICR7bWVzc2FnZX1gKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZXROb0NvbnRlbnRNZXNzYWdlKCkge1xyXG4gICAgICAgIHRoaXMuY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcclxuICAgICAgICAgICAgY2xzOiBcInBhbmUtZW1wdHlcIixcclxuICAgICAgICAgICAgdGV4dDogXCJOb3RoaW5nIHRvIGRpc3BsYXkuXCIsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRpc2Nvbm5lY3RPYnNlcnZlcnMoKSB7XHJcbiAgICAgICAgLy8gRGlzY29ubmVjdCBhbmQgY2xlYXIgb3V0IGN1cnJlbnQgb2JzZXJ2ZXJzLlxyXG4gICAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgdGhpcy5vYnNlcnZlcnMpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRWaWV3VHlwZSgpIHtcclxuICAgICAgICByZXR1cm4gdmlld1R5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzcGxheVRleHQoKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiU2lkZWJhciBJbmZvYm94XCI7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SWNvbigpIHtcclxuICAgICAgICByZXR1cm4gXCJsaW5lcy1vZi10ZXh0XCI7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25DbG9zZSgpIHtcclxuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPYnNlcnZlcnMoKTtcclxuICAgICAgICBhd2FpdCBzdXBlci5vbkNsb3NlKCk7XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IFNpZGViYXJJbmZvYm94IGZyb20gXCIuL21haW5cIjtcclxuaW1wb3J0IHtcclxuICAgIEFwcCxcclxuICAgIFBsdWdpblNldHRpbmdUYWIsXHJcbiAgICBTZXR0aW5nXHJcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNpZGViYXJJbmZvYm94U2V0dGluZ3Mge1xyXG4gICAgaW1hZ2VQcm9wZXJ0eTogc3RyaW5nLFxyXG4gICAgaW1hZ2VzUHJvcGVydHk6IHN0cmluZyxcclxuICAgIGV4Y2x1ZGVQcm9wZXJ0aWVzOiBzdHJpbmcsXHJcbiAgICBtYXhJbWFnZUhlaWdodDogTnVtYmVyO1xyXG4gICAgc29ydFByb3BlcnRpZXM6IGJvb2xlYW47XHJcbiAgICBjYXBpdGFsaXplUHJvcGVydHlOYW1lOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogU2lkZWJhckluZm9ib3hTZXR0aW5ncyA9IHtcclxuICAgIGltYWdlUHJvcGVydHk6IFwiaW1hZ2VcIixcclxuICAgIGltYWdlc1Byb3BlcnR5OiBcImltYWdlc1wiLFxyXG4gICAgZXhjbHVkZVByb3BlcnRpZXM6IFwiXCIsXHJcbiAgICBtYXhJbWFnZUhlaWdodDogNTAwLFxyXG4gICAgc29ydFByb3BlcnRpZXM6IGZhbHNlLFxyXG4gICAgY2FwaXRhbGl6ZVByb3BlcnR5TmFtZTogZmFsc2VcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNpZGViYXJJbmZvYm94U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcGx1Z2luOiBTaWRlYmFySW5mb2JveDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBTaWRlYmFySW5mb2JveCkge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIk1heGltdW0gSW1hZ2UgSGVpZ2h0XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVmFsdWUgaW4gcGl4ZWxzLiBTZXQgdG8gemVybyBmb3Igbm8gbWF4aW11bS5cIilcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoREVGQVVMVF9TRVRUSU5HUy5tYXhJbWFnZUhlaWdodC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heEltYWdlSGVpZ2h0Py50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heEltYWdlSGVpZ2h0ID0gcGFyc2VJbnQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJJbWFnZSBQcm9wZXJ0eVwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoZSBuYW1lIG9mIHRoZSBmcm9udG1hdHRlciBwcm9wZXJ0eSB0byB1c2UgZm9yIHRoZSBtYWluIGltYWdlIHNob3duIGFib3ZlIHRoZSBwcm9wZXJ0aWVzIHRhYmxlLiBJdCBzaG91bGQgYmUgdGhlIG5hbWUgb2YgdGhlIGltYWdlIGZpbGUgbG9jYXRlZCBzb21ld2hlcmUgaW4gdGhlIHZhdWx0LlwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihERUZBVUxUX1NFVFRJTkdTLmltYWdlUHJvcGVydHkpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW1hZ2VQcm9wZXJ0eSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbWFnZVByb3BlcnR5ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkltYWdlcyBQcm9wZXJ0eVwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoZSBuYW1lIG9mIHRoZSBmcm9udG1hdHRlciBwcm9wZXJ0eSB0byB1c2UgZm9yIGFkZGl0aW9uYWwgaW1hZ2VzLiBUaGlzIGlzIGFuIGFycmF5IHByb3BlcnR5LCB3aXRoIGVhY2ggdmFsdWUgYmVpbmcgdGhlIG5hbWUgb2YgdGhlIGltYWdlIGZpbGUgbG9jYXRlZCBzb21ld2hlcmUgaW4gdGhlIHZhdWx0LlwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihERUZBVUxUX1NFVFRJTkdTLmltYWdlc1Byb3BlcnR5KVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmltYWdlc1Byb3BlcnR5KVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmltYWdlc1Byb3BlcnR5ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkV4Y2x1ZGVkIFByb3BlcnRpZXNcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJUaGUgbmFtZXMgb2YgdGhlIGZyb250bWF0dGVyIHByb3BlcnRpZXMgdG8gZXhjbHVkZSBmcm9tIHRoZSB0YWJsZS4gTGlzdCB0aGVtIGFsbCBvbiBvbmUgbGluZSwgd2l0aCBlYWNoIGZvbGxvd2VkIGJ5IGEgY29tbWEuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlUHJvcGVydGllcylcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlUHJvcGVydGllcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJTb3J0IFByb3BlcnRpZXNcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJXaGV0aGVyIG9yIG5vdCB0byBzb3J0IHRoZSBwcm9wZXJ0aWVzIGFscGhhYmV0aWNhbGx5IGluIHRoZSB0YWJsZS5cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydFByb3BlcnRpZXMpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydFByb3BlcnRpZXMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQ2FwaXRhbGl6ZSBQcm9wZXJ0eSBOYW1lc1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIldoZXRoZXIgb3Igbm90IHRvIGNhcGl0YWxpemUgdGhlIHByb3BlcnR5IG5hbWVzLlwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXBpdGFsaXplUHJvcGVydHlOYW1lKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcGl0YWxpemVQcm9wZXJ0eU5hbWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgIH1cclxufVxyXG4iXSwKICAibWFw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
